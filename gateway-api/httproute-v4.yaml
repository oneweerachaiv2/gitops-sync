# HTTPRoute for API v4 using Gateway API
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: api-v4-users
  namespace: apisix-argocd
  labels:
    api-version: "v4"
    status: "experimental"
    environment: dev
spec:
  parentRefs:
    - name: apisix-gateway
      namespace: apisix-argocd
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /api/v4/users
          method: GET
        - path:
            type: PathPrefix
            value: /api/v4/users
          method: POST
        - path:
            type: PathPrefix
            value: /api/v4/users
          method: PUT
        - path:
            type: PathPrefix
            value: /api/v4/users
          method: PATCH
        - path:
            type: PathPrefix
            value: /api/v4/users
          method: DELETE
      backendRefs:
        - name: httpbin
          namespace: httpbin
          port: 8000
      filters:
        - type: ResponseHeaderModifier
          responseHeaderModifier:
            set:
              - name: X-API-Version
                value: "4"
              - name: X-API-Experimental
                value: "true"
              - name: X-Environment
                value: "development"
              - name: X-Deployed-By
                value: "Gateway-API-GitOps"

